modules:
  - name: periph_common
    sources:
      - periph_cpuid: [cpuid.c]
      - periph_eeprom: [eeprom.c]
      - periph_flashpage: [flashpage.c]
      - periph_i2c: [i2c.c]
      - periph_pm: [pm.c]
      - periph_spi: [spi.c]
      - periph_timer: [timer.c]
    env:
      local:
        CFLAGS:
          # workaround for this warning:
          # drivers/periph_common/cpuid.c: In function 'cpuid_get':
          # drivers/periph_common/cpuid.c:34:5: error: 'memcpy' offset [0, 7] is out of the bounds [0, 0] [-Werror=array-bounds]
          #   34 |     memcpy(id, (void *)CPUID_ADDR, CPUID_LEN);
          #      |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

          - -Wno-array-bounds

          # workaround for this warning:
          # drivers/periph_common/cpuid.c: In function 'cpuid_get':
          # drivers/periph_common/cpuid.c:34:5: error: 'memcpy' reading 8 bytes from a region of size 0 [-Werror=stringop-overread]
          #   34 |     memcpy(id, (void *)CPUID_ADDR, CPUID_LEN);
          #      |     ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          - -Wno-stringop-overread

    depends:
      - periph_common_init

    uses:
      - board
      - periph_flashpage_pagewise

  - name: periph_common_init
    sources:
      - init.c
    depends:
      - periph_common
    uses:
      - periph_hwrng
      - periph_i2c
      - periph_rtc
      - periph_rtt
      - periph_spi
      - periph_usbdev
      - periph_wdt

