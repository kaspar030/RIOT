context:
    name: cortexm
    parent: riot
    vars:
        PREFIX: arm-none-eabi-
        CFLAGS_STD:
            - -std=c99
        CFLAGS_ARCH:
            - -mlittle-endian -mthumb
            - -mno-thumb-interwork
        CFLAGS_CODEGEN:
            - -fno-common
            - -fno-delete-null-pointer-checks
        CFLAGS_DEFINES:
            - -DDONT_USE_CMSIS_INIT
            - -DCOREIF_NG=1
        LINKFLAGS:
            - -L${relpath}/ldscripts
            - -static
            - -nostartfiles
        includes:
            - ${relpath}/include
            - ${relpath}/include/vendor
            - ${root}/sys/libc/include
        libs:
            - -lm

module:
    - context: cortexm
      name: cortexm
      sources:
       - cortexm_init.c
       - irq_arch.c
       - mpu.c
       - panic.c
       - thread_arch.c
       - vectors_cortexm.c

      vars:
          CFLAGS:
              - -DMODULE_CORTEXM_COMMON
              - -DMODULE_NEWLIB

      depends:
          - core
          - newlib
          - cortexm_common_periph

    - name: feature/arch_32bit
      context: cortexm

    - name: mpu_stack_guard
      context: cortexm
    - name: printf_float
      context: cortexm

    - name: feature/cpp
      context: cortexm
      global_vars:
        LINK:
          - remove:
            - arm-none-eabi-gcc
          - arm-none-eabi-g++

subdirs:
    - periph
