defaults:
  module:
    context: stm32
    depends:
      - periph_common

module:
  - name: periph_flashpage
    depends:
      - periph_flash_common
    sources:
      - flashpage.c
    env:
      export:
        CFLAGS:
          - -DSTM32_FLASHSIZE=${FLASHSIZE}

  - name: periph_hwrng
    sources:
      - hwrng.c

  - name: periph_pm
    sources:
      - pm.c

  - name: periph_rtc
    sources:
      - rtc.c

        #  - name: periph_rtt
        #    context: stm32f1
        #    sources:
        #      - rtt_f1.c

  - name: periph_rtt
    sources:
      - rtt_all.c

  - name: periph_timer
    sources:
      - timer.c

  - name: periph_pwm
    depends:
      - periph_gpio
    sources:
      - pwm.c

  - name: periph_spi
    depends:
      - periph_gpio
    sources:
      - spi.c

  - name: periph_uart
    depends:
      - periph_gpio
    sources:
      - uart.c

  - name: periph_adc
    context:
      - stm32f4
        #- stm32f7
    sources:
      - adc_f4_f7.c

        #  - name: periph_adc
        #    context:
        #      - stm32f0
        #      - stm32g0
        #    sources:
        #      - adc_f0_g0.c

        #  - name: periph_adc
        #    context: stm32f1
        #    sources:
        #      - adc_f1.c
        #
        #  - name: periph_adc
        #    context: stm32f2
        #    sources:
        #      - adc_f2.c
        #
        #  - name: periph_adc
        #    context: stm32f3
        #    sources:
        #      - adc_f3.c
        #
        #  - name: periph_adc
        #    context: stm32l0
        #    sources:
        #      - adc_l0.c
        #
        #  - name: periph_adc
        #    context: stm32l1
        #    sources:
        #      - adc_l1.c
        #
        #  - name: periph_adc
        #    context: stm32l4
        #    sources:
        #      - adc_l4.c

  - name: periph_dac
    sources: [dac.c]
    depends: [feature/periph_dac]

    #  - name: periph_i2c
    #    context:
    #      - stm32f0
    #      - stm32f3
    #      - stm32f7
    #      - stm32g0
    #      - stm32g4
    #      - stm32l0
    #      - stm32l4
    #      - stm32l5
    #      - stm32wb
    #      - stm32wl
    #    sources: [i2c_1.c]

  - name: periph_i2c
    context:
      #- stm32f1
      #- stm32f2
      #- stm32l1
      - stm32f4
    sources: [i2c_2.c]

  - name: periph_gpio
    sources: [gpio_all.c]
    uses:
      - periph_gpio_irq

  # - name: periph_gpio
  #   context: stm32f1
  #   sources: [gpio_f1.c]
  #   uses:
  #     - periph_gpio_irq

  - name: periph_gpio_irq
    depends:
      - periph_gpio

  - name: periph_cpuid

  - name: periph_qdec
    sources: [qdec.c]
    depends:
      - periph_gpio
      - feature/periph_qdec

  - name: periph_eeprom
    sources: [eeprom.c]
    depends: 
     - feature/periph_eeprom
     - periph_flash_common

 # flashpage and eeprom periph implementations share flash lock/unlock functions
 # defined in flash_common.c
  - name: periph_flash_common
    sources:
      - flash_common.c
